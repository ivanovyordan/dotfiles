# vim: syntax=sh

layout_poetry() {
    poetry run true

    export VIRTUAL_ENV=$(poetry env info --path)
    export POETRY_ACTIVE=1
    PATH_add "$VIRTUAL_ENV/bin"
}

install_python_version() {
    local required=$(head .python-version)
    pyenv install -s
}

use_python() {
    if test -f ".python-version"; then
        install_python_version
    fi

    if test -f "Pipfile"; then
        layout pipenv

    else
        if test -f "pyproject.toml"; then
            if test -f ".python-version"; then
                layout pyenv $(head .python-version)
            fi
            layout poetry

        else
            layout python
        fi
    fi
}
